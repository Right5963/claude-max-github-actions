#!/usr/bin/env python3
"""
ã‚·ã‚¹ãƒ†ãƒ ç›®çš„åˆ†æ
================
ãªãœå„ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã£ãŸã®ã‹ã€æœ¬å½“ã®å¿…è¦æ€§ã‚’åˆ†æ
"""

import os
import json
from datetime import datetime

def analyze_system_purposes():
    """å„ã‚·ã‚¹ãƒ†ãƒ ã®ä½œæˆç›®çš„ã‚’åˆ†æ"""
    
    system_purposes = {
        
        # === ãƒ¤ãƒ•ã‚ªã‚¯è‡ªå‹•åŒ–ç³» ===
        "yahoo_auction_real_automation.py": {
            "ç›®çš„": "ãƒ¤ãƒ•ã‚ªã‚¯ã§ã®å£²ä¸Šã‚’è‡ªå‹•åŒ–ãƒ»åŠ¹ç‡åŒ–",
            "ãªãœå¿…è¦": "æ‰‹å‹•ã§ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã‚‹ã€ãƒŸã‚¹ãŒç™ºç”Ÿã™ã‚‹",
            "æ ¸å¿ƒä¾¡å€¤": "å£²ä¸Šç›´çµã€æ™‚é–“çŸ­ç¸®",
            "çŠ¶æ³": "17KBã€è¤‡é›‘ã™ãã¦ä½¿ãˆãªã„",
            "å¯¾ç­–": "ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆã«ä½œã‚Šç›´ã—"
        },
        
        "yahoo_auto.py": {
            "ç›®çš„": "ãƒ¤ãƒ•ã‚ªã‚¯æ“ä½œã®åŸºæœ¬è‡ªå‹•åŒ–", 
            "ãªãœå¿…è¦": "ç¹°ã‚Šè¿”ã—ä½œæ¥­ã®åŠ¹ç‡åŒ–",
            "æ ¸å¿ƒä¾¡å€¤": "ä½œæ¥­æ™‚é–“å‰Šæ¸›",
            "çŠ¶æ³": "å‹•ä½œä¸å¯",
            "å¯¾ç­–": "ä¿®å¾©ã¾ãŸã¯çµ±åˆ"
        },
        
        "yahoo_sales_analyzer.py": {
            "ç›®çš„": "ãƒ¤ãƒ•ã‚ªã‚¯å£²ä¸Šãƒ‡ãƒ¼ã‚¿åˆ†æ",
            "ãªãœå¿…è¦": "å£²ä¸Šãƒ‘ã‚¿ãƒ¼ãƒ³æŠŠæ¡ã€æ”¹å–„ç‚¹ç™ºè¦‹",
            "æ ¸å¿ƒä¾¡å€¤": "ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªæ”¹å–„",
            "çŠ¶æ³": "9KBã€è¦ãƒ†ã‚¹ãƒˆ",
            "å¯¾ç­–": "å‹•ä½œç¢ºèªã—ã¦ä¿æŒ"
        },
        
        "yahoo_image_downloader.py": {
            "ç›®çš„": "ç«¶åˆå•†å“ç”»åƒã®åé›†ãƒ»åˆ†æ",
            "ãªãœå¿…è¦": "ç«¶åˆç ”ç©¶ã€ç”»åƒå“è³ªæ¯”è¼ƒ",
            "æ ¸å¿ƒä¾¡å€¤": "ç«¶åˆåˆ†æã®åŠ¹ç‡åŒ–",
            "çŠ¶æ³": "2KBã€è»½é‡",
            "å¯¾ç­–": "ä¿æŒãƒ»æ”¹å–„"
        },
        
        "yahoo_tagger_workflow.py": {
            "ç›®çš„": "å•†å“ã‚¿ã‚°ä»˜ã‘ã®åŠ¹ç‡åŒ–",
            "ãªãœå¿…è¦": "é©åˆ‡ãªã‚¿ã‚°ã§æ¤œç´¢æ€§å‘ä¸Š",
            "æ ¸å¿ƒä¾¡å€¤": "å£²ä¸Šå‘ä¸Šã«ç›´çµ",
            "çŠ¶æ³": "3KBã€ã‚·ãƒ³ãƒ—ãƒ«",
            "å¯¾ç­–": "ä¿æŒ"
        },
        
        # === ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ»AIç”»åƒç”Ÿæˆç³» ===
        "advanced_wildcard_generator.py": {
            "ç›®çš„": "é«˜åº¦ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã§AIç”»åƒå“è³ªå‘ä¸Š",
            "ãªãœå¿…è¦": "æ‰‹å‹•ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆã¯éåŠ¹ç‡",
            "æ ¸å¿ƒä¾¡å€¤": "ç”»åƒå“è³ª â†’ å£²ä¸Šå‘ä¸Š",
            "çŠ¶æ³": "8KBã€ä¸­ç¨‹åº¦è¤‡é›‘",
            "å¯¾ç­–": "æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå¾Œåˆ¤æ–­"
        },
        
        "simple_wildcard_generator.py": {
            "ç›®çš„": "ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ",
            "ãªãœå¿…è¦": "æ—¥å¸¸çš„ãªAIç”»åƒç”ŸæˆåŠ¹ç‡åŒ–",
            "æ ¸å¿ƒä¾¡å€¤": "åˆ¶ä½œæ™‚é–“çŸ­ç¸®",
            "çŠ¶æ³": "6KBã€é©åº¦",
            "å¯¾ç­–": "ä¿æŒ"
        },
        
        "advanced_tagger_system.py": {
            "ç›®çš„": "é«˜åº¦ãªè‡ªå‹•ã‚¿ã‚°ä»˜ã‘ã‚·ã‚¹ãƒ†ãƒ ",
            "ãªãœå¿…è¦": "å¤§é‡ç”»åƒã®åŠ¹ç‡çš„åˆ†é¡",
            "æ ¸å¿ƒä¾¡å€¤": "ä½œæ¥­åŠ¹ç‡åŒ–",
            "çŠ¶æ³": "12KBã€è¤‡é›‘",
            "å¯¾ç­–": "ç°¡ç´ åŒ–ç‰ˆä½œæˆ"
        },
        
        "poster_prompt_generator.py": {
            "ç›®çš„": "ãƒã‚¹ã‚¿ãƒ¼å°‚ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ",
            "ãªãœå¿…è¦": "ãƒã‚¹ã‚¿ãƒ¼å£²ä¸Šã«ç‰¹åŒ–ã—ãŸæœ€é©åŒ–",
            "æ ¸å¿ƒä¾¡å€¤": "å£²ä¸Šç›´çµ",
            "çŠ¶æ³": "1KBã€è¶…è»½é‡",
            "å¯¾ç­–": "çµ¶å¯¾ä¿æŒ"
        },
        
        # === CivitAIãƒ»ãƒ¢ãƒ‡ãƒ«ç³» ===
        "civitai_model_fetcher.py": {
            "ç›®çš„": "CivitAIã‹ã‚‰æœ€æ–°ãƒ¢ãƒ‡ãƒ«æƒ…å ±å–å¾—",
            "ãªãœå¿…è¦": "æœ€æ–°æŠ€è¡“ã§ã‚ˆã‚Šè‰¯ã„ç”»åƒç”Ÿæˆ",
            "æ ¸å¿ƒä¾¡å€¤": "ç«¶äº‰åŠ›ç¶­æŒ",
            "çŠ¶æ³": "7KBã€é‡è¦æ©Ÿèƒ½",
            "å¯¾ç­–": "å‹•ä½œç¢ºèªãƒ»ä¿®å¾©"
        },
        
        "civitai_popularity_fixed.py": {
            "ç›®çš„": "CivitAIäººæ°—ãƒ¢ãƒ‡ãƒ«åˆ†æ",
            "ãªãœå¿…è¦": "å¸‚å ´ãƒˆãƒ¬ãƒ³ãƒ‰æŠŠæ¡",
            "æ ¸å¿ƒä¾¡å€¤": "å¸‚å ´é©å¿œåŠ›",
            "çŠ¶æ³": "ä¿®æ­£æ¸ˆã¿ã ãŒå‹•ä½œä¸å¯",
            "å¯¾ç­–": "å†ä¿®æ­£å¿…é ˆ"
        },
        
        # === AIåˆ†æãƒ»æ´å¯Ÿç³» ===
        "ai_insight_evaluator.py": {
            "ç›®çš„": "AI ã«ã‚ˆã‚‹æ·±ã„æ´å¯Ÿã¨æ”¹å–„ææ¡ˆ",
            "ãªãœå¿…è¦": "äººé–“ã§ã¯æ°—ã¥ã‹ãªã„æ”¹å–„ç‚¹ç™ºè¦‹",
            "æ ¸å¿ƒä¾¡å€¤": "å£²ä¸Šæ”¹å–„ã®è³ªå‘ä¸Š",
            "çŠ¶æ³": "å‹•ä½œç¢ºèªæ¸ˆã¿",
            "å¯¾ç­–": "ä¿æŒãƒ»æ´»ç”¨"
        },
        
        "image_quality_evaluator.py": {
            "ç›®çš„": "AIç”»åƒã®å“è³ªè‡ªå‹•è©•ä¾¡",
            "ãªãœå¿…è¦": "å£²ã‚Œã‚‹ç”»åƒã®å®¢è¦³çš„åˆ¤å®š",
            "æ ¸å¿ƒä¾¡å€¤": "å£²ä¸Šäºˆæ¸¬ç²¾åº¦å‘ä¸Š",
            "çŠ¶æ³": "9KBã€æœªãƒ†ã‚¹ãƒˆ",
            "å¯¾ç­–": "ãƒ†ã‚¹ãƒˆãƒ»ä¿®å¾©"
        },
        
        # === æ€è€ƒãƒ»ç ”ç©¶ç³» ===
        "integrated_thinking_research_system.py": {
            "ç›®çš„": "åŒ…æ‹¬çš„æ€è€ƒãƒ»ç ”ç©¶ã‚·ã‚¹ãƒ†ãƒ ",
            "ãªãœå¿…è¦": "è¤‡é›‘ãªå•é¡Œã®ä½“ç³»çš„è§£æ±º",
            "æ ¸å¿ƒä¾¡å€¤": "å•é¡Œè§£æ±ºèƒ½åŠ›ã®å‘ä¸Š",
            "çŠ¶æ³": "32KBã€ä½¿ç”¨ä¸å¯",
            "å¯¾ç­–": "æ ¸å¿ƒæ©Ÿèƒ½ã®ã¿æŠ½å‡ºã—ã¦å†æ§‹ç¯‰"
        },
        
        "thinking_enhancement_practice.py": {
            "ç›®çš„": "æ€è€ƒåŠ›å‘ä¸Šã®ãŸã‚ã®ç·´ç¿’ã‚·ã‚¹ãƒ†ãƒ ",
            "ãªãœå¿…è¦": "ã‚ˆã‚Šè‰¯ã„åˆ¤æ–­ãƒ»æˆ¦ç•¥ç«‹æ¡ˆ",
            "æ ¸å¿ƒä¾¡å€¤": "æ„æ€æ±ºå®šã®è³ªå‘ä¸Š",
            "çŠ¶æ³": "6KBã€è¦ä¿®æ­£",
            "å¯¾ç­–": "ä¿®å¾©ã—ã¦ä¿æŒ"
        },
        
        # === è‡ªå‹•åŒ–ãƒ»åŠ¹ç‡åŒ–ç³» ===
        "one_click_automation.py": {
            "ç›®çš„": "ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã®ä½œæ¥­è‡ªå‹•åŒ–",
            "ãªãœå¿…è¦": "è¤‡é›‘ãªä½œæ¥­ã®ç°¡å˜å®Ÿè¡Œ",
            "æ ¸å¿ƒä¾¡å€¤": "ä½œæ¥­åŠ¹ç‡ã®åŠ‡çš„å‘ä¸Š",
            "çŠ¶æ³": "13KBã€è¦ãƒ†ã‚¹ãƒˆ",
            "å¯¾ç­–": "æ©Ÿèƒ½ç¢ºèªãƒ»ç°¡ç´ åŒ–"
        },
        
        "session_manager.py": {
            "ç›®çš„": "ä½œæ¥­ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ç®¡ç†ãƒ»å¾©å…ƒ",
            "ãªãœå¿…è¦": "ä½œæ¥­ã®ç¶™ç¶šæ€§ç¢ºä¿",
            "æ ¸å¿ƒä¾¡å€¤": "ç”Ÿç”£æ€§å‘ä¸Š",
            "çŠ¶æ³": "13KBã€é‡è¦æ©Ÿèƒ½",
            "å¯¾ç­–": "å‹•ä½œç¢ºèªãƒ»ä¿æŒ"
        }
    }
    
    return system_purposes

def categorize_by_business_value():
    """ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤åˆ¥åˆ†é¡"""
    
    purposes = analyze_system_purposes()
    
    categories = {
        "å£²ä¸Šç›´çµ": [],
        "åŠ¹ç‡åŒ–": [], 
        "åˆ†æãƒ»æ´å¯Ÿ": [],
        "æŠ€è¡“åŸºç›¤": [],
        "å®Ÿé¨“ãƒ»ç ”ç©¶": []
    }
    
    for system, info in purposes.items():
        value = info["æ ¸å¿ƒä¾¡å€¤"]
        
        if "å£²ä¸Š" in value:
            categories["å£²ä¸Šç›´çµ"].append(system)
        elif "åŠ¹ç‡" in value or "æ™‚é–“" in value:
            categories["åŠ¹ç‡åŒ–"].append(system)
        elif "åˆ†æ" in value or "æ´å¯Ÿ" in value:
            categories["åˆ†æãƒ»æ´å¯Ÿ"].append(system)
        elif "ç«¶äº‰åŠ›" in value or "æŠ€è¡“" in value:
            categories["æŠ€è¡“åŸºç›¤"].append(system)
        else:
            categories["å®Ÿé¨“ãƒ»ç ”ç©¶"].append(system)
    
    return categories

def identify_critical_systems():
    """é‡è¦ã‚·ã‚¹ãƒ†ãƒ ç‰¹å®š"""
    
    purposes = analyze_system_purposes()
    categories = categorize_by_business_value()
    
    critical_systems = {
        "å³ä¿®å¾©å¿…é ˆ": [],
        "ä¿æŒãƒ»æ”¹å–„": [],
        "ç°¡ç´ åŒ–": [],
        "çµ±åˆå€™è£œ": [],
        "è¦æ¤œè¨": []
    }
    
    for system, info in purposes.items():
        status = info["çŠ¶æ³"]
        value = info["æ ¸å¿ƒä¾¡å€¤"]
        action = info["å¯¾ç­–"]
        
        if "å£²ä¸Šç›´çµ" in value and "å‹•ä½œä¸å¯" in status:
            critical_systems["å³ä¿®å¾©å¿…é ˆ"].append(system)
        elif "å‹•ä½œç¢ºèªæ¸ˆã¿" in status:
            critical_systems["ä¿æŒãƒ»æ”¹å–„"].append(system)
        elif "è¤‡é›‘ã™ã" in status:
            critical_systems["ç°¡ç´ åŒ–"].append(system)
        elif "çµ±åˆ" in action:
            critical_systems["çµ±åˆå€™è£œ"].append(system)
        else:
            critical_systems["è¦æ¤œè¨"].append(system)
    
    return critical_systems

def generate_reconstruction_plan():
    """å†æ§‹ç¯‰è¨ˆç”»ç”Ÿæˆ"""
    
    critical = identify_critical_systems()
    categories = categorize_by_business_value()
    
    plan = {
        "Phase1_ç·Šæ€¥ä¿®å¾©": {
            "å¯¾è±¡": critical["å³ä¿®å¾©å¿…é ˆ"],
            "æœŸé™": "å³åº§",
            "ç›®çš„": "å£²ä¸Šã«ç›´çµã™ã‚‹æ©Ÿèƒ½ã®å¾©æ—§"
        },
        "Phase2_åŠ¹ç‡åŒ–": {
            "å¯¾è±¡": critical["ç°¡ç´ åŒ–"] + categories["åŠ¹ç‡åŒ–"],
            "æœŸé™": "1é€±é–“ä»¥å†…",
            "ç›®çš„": "æ—¥å¸¸ä½œæ¥­ã®åŠ¹ç‡åŒ–"
        },
        "Phase3_åˆ†æå¼·åŒ–": {
            "å¯¾è±¡": categories["åˆ†æãƒ»æ´å¯Ÿ"],
            "æœŸé™": "2é€±é–“ä»¥å†…", 
            "ç›®çš„": "ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªæ”¹å–„"
        },
        "Phase4_æŠ€è¡“åŸºç›¤": {
            "å¯¾è±¡": categories["æŠ€è¡“åŸºç›¤"],
            "æœŸé™": "1ãƒ¶æœˆä»¥å†…",
            "ç›®çš„": "é•·æœŸçš„ç«¶äº‰åŠ›ã®ç¢ºä¿"
        }
    }
    
    return plan

def main():
    """ã‚·ã‚¹ãƒ†ãƒ ç›®çš„åˆ†æå®Ÿè¡Œ"""
    
    print("ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ ç›®çš„åˆ†æ")
    print("ãªãœå„ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã£ãŸã®ã‹ã€æœ¬å½“ã®å¿…è¦æ€§ã‚’æ¤œè¨¼")
    print("=" * 70)
    
    # ç›®çš„åˆ†æ
    purposes = analyze_system_purposes()
    
    # ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤åˆ†é¡
    categories = categorize_by_business_value()
    
    print("ğŸ“Š ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤åˆ¥åˆ†é¡:")
    for category, systems in categories.items():
        print(f"\n{category} ({len(systems)}å€‹):")
        for system in systems:
            print(f"  â€¢ {system}")
    
    # é‡è¦ã‚·ã‚¹ãƒ†ãƒ ç‰¹å®š
    critical = identify_critical_systems()
    
    print(f"\nğŸš¨ é‡è¦åº¦åˆ¥åˆ†é¡:")
    for importance, systems in critical.items():
        print(f"\n{importance} ({len(systems)}å€‹):")
        for system in systems:
            purpose_info = purposes.get(system, {})
            print(f"  â€¢ {system}")
            print(f"    ç›®çš„: {purpose_info.get('ç›®çš„', 'ä¸æ˜')}")
            print(f"    ä¾¡å€¤: {purpose_info.get('æ ¸å¿ƒä¾¡å€¤', 'ä¸æ˜')}")
    
    # å†æ§‹ç¯‰è¨ˆç”»
    plan = generate_reconstruction_plan()
    
    print(f"\nğŸ“‹ å†æ§‹ç¯‰è¨ˆç”»:")
    for phase, details in plan.items():
        print(f"\n{phase}:")
        print(f"  ç›®çš„: {details['ç›®çš„']}")
        print(f"  æœŸé™: {details['æœŸé™']}")
        print(f"  å¯¾è±¡: {len(details['å¯¾è±¡'])}å€‹")
        for system in details['å¯¾è±¡'][:3]:  # æœ€åˆã®3å€‹è¡¨ç¤º
            print(f"    â€¢ {system}")
        if len(details['å¯¾è±¡']) > 3:
            print(f"    ... ä»–{len(details['å¯¾è±¡'])-3}å€‹")
    
    # çµæœä¿å­˜
    result = {
        'analysis_date': datetime.now().isoformat(),
        'system_purposes': purposes,
        'business_categories': categories,
        'critical_classification': critical,
        'reconstruction_plan': plan
    }
    
    with open('system_purpose_analysis.json', 'w', encoding='utf-8') as f:
        json.dump(result, f, ensure_ascii=False, indent=2)
    
    print(f"\nğŸ’¡ çµè«–:")
    print("å…¨ã¦ã®ã‚·ã‚¹ãƒ†ãƒ ã«æ˜ç¢ºãªç›®çš„ãŒã‚ã‚‹ã€‚")
    print("å•é¡Œã¯ã€Œå®Ÿè£…ã®è¤‡é›‘åŒ–ã€ã§ã‚ã‚Šã€Œæ©Ÿèƒ½ã®ä¸è¦æ€§ã€ã§ã¯ãªã„ã€‚")
    print("â†’ å‰Šé™¤ã§ã¯ãªãä¿®å¾©ãƒ»ç°¡ç´ åŒ–ãŒæ­£è§£")
    
    print(f"\nğŸ“ è©³ç´°åˆ†æä¿å­˜: system_purpose_analysis.json")

if __name__ == "__main__":
    main()